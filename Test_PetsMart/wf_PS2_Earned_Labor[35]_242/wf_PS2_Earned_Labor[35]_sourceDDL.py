# Databricks notebook source
# COMMAND ----------

CREATE DATABASE IF NOT EXISTS DELTA_TRAINING;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.DAYS(DAY_DT TIMESTAMP,
BUSINESS_DAY_FLAG STRING,
HOLIDAY_FLAG STRING,
DAY_OF_WK_NAME STRING,
DAY_OF_WK_NAME_ABBR STRING,
DAY_OF_WK_NBR INT,
CAL_DAY_OF_MO_NBR INT,
CAL_DAY_OF_YR_NBR INT,
CAL_WK INT,
CAL_WK_NBR INT,
CAL_MO INT,
CAL_MO_NBR INT,
CAL_MO_NAME STRING,
CAL_MO_NAME_ABBR STRING,
CAL_QTR INT,
CAL_QTR_NBR INT,
CAL_HALF INT,
CAL_YR INT,
FISCAL_DAY_OF_MO_NBR INT,
FISCAL_DAY_OF_YR_NBR INT,
FISCAL_WK INT,
FISCAL_WK_NBR INT,
FISCAL_MO INT,
FISCAL_MO_NBR INT,
FISCAL_MO_NAME STRING,
FISCAL_MO_NAME_ABBR STRING,
FISCAL_QTR INT,
FISCAL_QTR_NBR INT,
FISCAL_HALF INT,
FISCAL_YR INT,
LYR_WEEK_DT TIMESTAMP,
LWK_WEEK_DT TIMESTAMP,
WEEK_DT TIMESTAMP,
EST_TIME_CONV_AMT INT,
EST_TIME_CONV_HRS INT,
ES0_TIME_CONV_AMT INT,
ES0_TIME_CONV_HRS INT,
CST_TIME_CONV_AMT INT,
CST_TIME_CONV_HRS INT,
CS0_TIME_CONV_AMT INT,
CS0_TIME_CONV_HRS INT,
MST_TIME_CONV_AMT INT,
MST_TIME_CONV_HRS INT,
MS0_TIME_CONV_AMT INT,
MS0_TIME_CONV_HRS INT,
PST_TIME_CONV_AMT INT,
PST_TIME_CONV_HRS INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.TP_SERVICE_SCHEDULE(DAY_DT TIMESTAMP,
LOCATION_ID INT,
TP_INVOICE_NBR BIGINT,
UPC_ID BIGINT,
SERVICE_ITEM_ID BIGINT,
FOLIO_STATUS_FLAG STRING,
PRODUCT_ID INT,
ROOM_NUMBER STRING,
ROOM_TYPE_ID INT,
SERVICE_SCHEDULE_QTY INT,
SERVICE_FREQ_ID INT,
LOAD_DT TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_HTL_EARNED_PRE(EARN_DAY_DT DATE,
LOCATION_ID INT,
WEEK_DT DATE,
OVERNIGHT_KITTY_GUEST_CNT INT,
OVERNIGHT_DOG_GUEST_CNT INT,
OVERNIGHT_TOTAL_GUEST_CNT INT,
DAY_CAMP_PLAYROOM_CNT INT,
DAY_CARE_CNT INT,
OVERNIGHT_WITH_DDC_CNT INT,
TOTAL_DAYCAMP_CNT INT,
TOTAL_GUEST_CNT INT,
NIGHT_PETCARE_SPECIALIST_HRS INT,
FRONT_DESK_HRS INT,
BACK_OF_HOUSE_HRS INT,
SUPERVISOR_HRS INT,
PLAYROOM_HRS INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.SITE_PROFILE(LOCATION_ID INT,
LOCATION_TYPE_ID INT,
STORE_NBR INT,
STORE_NAME STRING,
STORE_TYPE_ID STRING,
STORE_OPEN_CLOSE_FLAG STRING,
COMPANY_ID INT,
REGION_ID BIGINT,
DISTRICT_ID BIGINT,
PRICE_ZONE_ID STRING,
PRICE_AD_ZONE_ID STRING,
REPL_DC_NBR INT,
REPL_FISH_DC_NBR INT,
REPL_FWD_DC_NBR INT,
SQ_FEET_RETAIL FLOAT,
SQ_FEET_TOTAL FLOAT,
SITE_ADDRESS STRING,
SITE_CITY STRING,
STATE_CD STRING,
COUNTRY_CD STRING,
POSTAL_CD STRING,
SITE_MAIN_TELE_NO STRING,
SITE_GROOM_TELE_NO STRING,
SITE_EMAIL_ADDRESS STRING,
SITE_SALES_FLAG STRING,
EQUINE_MERCH_ID INT,
EQUINE_SITE_ID INT,
EQUINE_SITE_OPEN_DT TIMESTAMP,
GEO_LATITUDE_NBR INT,
GEO_LONGITUDE_NBR INT,
PETSMART_DMA_CD STRING,
LOYALTY_PGM_TYPE_ID INT,
LOYALTY_PGM_STATUS_ID INT,
LOYALTY_PGM_START_DT TIMESTAMP,
LOYALTY_PGM_CHANGE_DT TIMESTAMP,
BP_COMPANY_NBR INT,
BP_GL_ACCT INT,
TP_LOC_FLAG STRING,
TP_ACTIVE_CNT INT,
PROMO_LABEL_CD STRING,
PARENT_LOCATION_ID INT,
LOCATION_NBR STRING,
TIME_ZONE_ID STRING,
DELV_SERVICE_CLASS_ID STRING,
PICK_SERVICE_CLASS_ID STRING,
SITE_LOGIN_ID STRING,
SITE_MANAGER_ID INT,
SITE_OPEN_YRS_AMT INT,
HOTEL_FLAG INT,
DAYCAMP_FLAG INT,
VET_FLAG INT,
DIST_MGR_NAME STRING,
DIST_SVC_MGR_NAME STRING,
REGION_VP_NAME STRING,
REGION_TRAINER_NAME STRING,
ASSET_PROTECT_NAME STRING,
SITE_COUNTY STRING,
SITE_FAX_NO STRING,
SFT_OPEN_DT TIMESTAMP,
DM_EMAIL_ADDRESS STRING,
DSM_EMAIL_ADDRESS STRING,
RVP_EMAIL_ADDRESS STRING,
TRADE_AREA STRING,
FDLPS_NAME STRING,
FDLPS_EMAIL STRING,
OVERSITE_MGR_NAME STRING,
OVERSITE_MGR_EMAIL STRING,
SAFETY_DIRECTOR_NAME STRING,
SAFETY_DIRECTOR_EMAIL STRING,
RETAIL_MANAGER_SAFETY_NAME STRING,
RETAIL_MANAGER_SAFETY_EMAIL STRING,
AREA_DIRECTOR_NAME STRING,
AREA_DIRECTOR_EMAIL STRING,
DC_GENERAL_MANAGER_NAME STRING,
DC_GENERAL_MANAGER_EMAIL STRING,
ASST_DC_GENERAL_MANAGER_NAME1 STRING,
ASST_DC_GENERAL_MANAGER_EMAIL1 STRING,
ASST_DC_GENERAL_MANAGER_NAME2 STRING,
ASST_DC_GENERAL_MANAGER_EMAIL2 STRING,
REGIONAL_DC_SAFETY_MGR_NAME STRING,
REGIONAL_DC_SAFETY_MGR_EMAIL STRING,
DC_PEOPLE_SUPERVISOR_NAME STRING,
DC_PEOPLE_SUPERVISOR_EMAIL STRING,
PEOPLE_MANAGER_NAME STRING,
PEOPLE_MANAGER_EMAIL STRING,
ASSET_PROT_DIR_NAME STRING,
ASSET_PROT_DIR_EMAIL STRING,
SR_REG_ASSET_PROT_MGR_NAME STRING,
SR_REG_ASSET_PROT_MGR_EMAIL STRING,
REG_ASSET_PROT_MGR_NAME STRING,
REG_ASSET_PROT_MGR_EMAIL STRING,
ASSET_PROTECT_EMAIL STRING,
TP_START_DT TIMESTAMP,
OPEN_DT TIMESTAMP,
GR_OPEN_DT TIMESTAMP,
CLOSE_DT TIMESTAMP,
HOTEL_OPEN_DT TIMESTAMP,
ADD_DT TIMESTAMP,
DELETE_DT TIMESTAMP,
UPDATE_DT TIMESTAMP,
LOAD_DT TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_HTL_VARIABLES(STORE_NBR INT,
DEFAULT_STORE_FLAG STRING,
PS2_HTL_VAR_REC_EFF_DT DATE,
PS2_HTL_VAR_REC_END_DT DATE,
TY_WEIGHT_PCNT INT,
LY_WEIGHT_PCNT INT,
FRONT_DESK_FIXED_HRS INT,
FRONT_DESK_VAR_HRS INT,
PLAYROOM_VAR_HRS INT,
BACK_OF_HOUSE_FIXED_HRS INT,
BACK_OF_HOUSE_VAR_HRS INT,
OVERNIGHT_TRESHHOLD INT,
OVERNIGHT_UPPER_VALUE INT,
OVERNIGHT_LOWER_VALUE INT,
SUPERVISOR_HRS INT,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_HTL_PLAYROOM_CAPACITY(LOCATION_ID INT,
DAY_OF_WEEK STRING,
PLAYROOM_CAP_EFF_DT DATE,
PLAYROOM_CAP_END_DT DATE,
STORE_NBR INT,
PLAYROOM_01_CAPACITY INT,
PLAYROOM_02_CAPACITY INT,
PLAYROOM_03_CAPACITY INT,
PLAYROOM_04_CAPACITY INT,
PLAYROOM_05_CAPACITY INT,
PLAYROOM_06_CAPACITY INT,
PLAYROOM_07_CAPACITY INT,
PLAYROOM_08_CAPACITY INT,
PLAYROOM_09_CAPACITY INT,
PLAYROOM_10_CAPACITY INT,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_HTL_ETL_CONTROL(PS2_HTL_PROCESS_ID INT,
PS2_HTL_PROCESS_DESC STRING,
PS2_HTL_RUN_DT DATE,
UPDATE_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.SKU_PROFILE(PRODUCT_ID INT,
SKU_NBR INT,
SKU_TYPE STRING,
PRIMARY_UPC_ID BIGINT,
STATUS_ID STRING,
SUBS_HIST_FLAG STRING,
SUBS_CURR_FLAG STRING,
SKU_DESC STRING,
ALT_DESC STRING,
SAP_CATEGORY_ID INT,
SAP_CLASS_ID INT,
SAP_DEPT_ID INT,
SAP_DIVISION_ID INT,
PRIMARY_VENDOR_ID BIGINT,
PARENT_VENDOR_ID BIGINT,
COUNTRY_CD STRING,
IMPORT_FLAG STRING,
HTS_CODE_ID BIGINT,
CONTENTS INT,
CONTENTS_UNITS STRING,
WEIGHT_NET_AMT INT,
WEIGHT_UOM_CD STRING,
SIZE_DESC STRING,
BUM_QTY FLOAT,
UOM_CD STRING,
UNIT_NUMERATOR FLOAT,
UNIT_DENOMINATOR FLOAT,
BUYER_ID STRING,
PURCH_GROUP_ID INT,
PURCH_COST_AMT INT,
NAT_PRICE_US_AMT INT,
TAX_CLASS_ID STRING,
VALUATION_CLASS_CD STRING,
BRAND_CD STRING,
BRAND_CLASSIFICATION_ID INT,
OWNBRAND_FLAG STRING,
STATELINE_FLAG STRING,
SIGN_TYPE_CD STRING,
OLD_ARTICLE_NBR STRING,
VENDOR_ARTICLE_NBR STRING,
INIT_MKDN_DT TIMESTAMP,
DISC_START_DT TIMESTAMP,
ADD_DT TIMESTAMP,
DELETE_DT TIMESTAMP,
UPDATE_DT TIMESTAMP,
FIRST_SALE_DT TIMESTAMP,
LAST_SALE_DT TIMESTAMP,
FIRST_INV_DT TIMESTAMP,
LAST_INV_DT TIMESTAMP,
LOAD_DT TIMESTAMP,
BASE_NBR STRING,
BP_COLOR_ID STRING,
BP_SIZE_ID STRING,
BP_BREED_ID STRING,
BP_ITEM_CONCATENATED STRING,
BP_AEROSOL_FLAG INT,
BP_HAZMAT_FLAG INT,
CANADIAN_HTS_CD STRING,
NAT_PRICE_CA_AMT INT,
NAT_PRICE_PR_AMT INT,
RTV_DEPT_CD STRING,
GL_ACCT_NBR INT,
ARTICLE_CATEGORY_ID INT,
COMPONENT_FLAG STRING,
ZDISCO_SCHED_TYPE_ID STRING,
ZDISCO_MKDN_SCHED_ID STRING,
ZDISCO_PID_DT TIMESTAMP,
ZDISCO_START_DT TIMESTAMP,
ZDISCO_INIT_MKDN_DT TIMESTAMP,
ZDISCO_DC_DT TIMESTAMP,
ZDISCO_STR_DT TIMESTAMP,
ZDISCO_STR_OWNRSHP_DT TIMESTAMP,
ZDISCO_STR_WRT_OFF_DT TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.SALES_DAY_SKU_STORE_RPT(DAY_DT TIMESTAMP,
PRODUCT_ID INT,
LOCATION_ID INT,
SALES_CUST_CAPTURE_CD STRING,
WEEK_DT TIMESTAMP,
FISCAL_YR INT,
SKU_NBR INT,
STORE_NBR INT,
OPT_SALES_TYPE_ID INT,
VENDOR_ID BIGINT,
PROMO_FLAG INT,
STATUS_ID STRING,
BRAND_NAME STRING,
OWNBRAND_FLAG STRING,
SKU_VEND_TXN_CNT INT,
NET_SALES_AMT INT,
NET_SALES_QTY INT,
NET_MARGIN_AMT INT,
SALES_AMT INT,
SALES_COST INT,
SALES_QTY INT,
RETURN_AMT INT,
RETURN_COST INT,
RETURN_QTY INT,
CLEARANCE_AMT INT,
CLEARANCE_QTY INT,
CLEARANCE_RETURN_AMT INT,
CLEARANCE_RETURN_QTY INT,
DISCOUNT_AMT INT,
DISCOUNT_QTY INT,
DISCOUNT_RETURN_AMT INT,
DISCOUNT_RETURN_QTY INT,
POS_COUPON_AMT INT,
POS_COUPON_QTY INT,
SPECIAL_SALES_AMT INT,
SPECIAL_SALES_QTY INT,
SPECIAL_RETURN_AMT INT,
SPECIAL_RETURN_QTY INT,
SPECIAL_SRVC_AMT INT,
SPECIAL_SRVC_QTY INT,
MA_SALES_AMT INT,
MA_SALES_QTY BIGINT,
MA_TRANS_AMT INT,
MA_TRANS_COST INT,
MA_TRANS_QTY BIGINT,
EXCH_RATE_PCT INT,
UPDATE_DT TIMESTAMP,
LOAD_DT TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.UDH_PS2_HTL_PLAYROOM_CAPACITY(STORE_NBR INT,
EFF_DT TIMESTAMP,
END_DT TIMESTAMP,
DAY_OF_WEEK STRING,
NORMAL_HRS_ROOM_QTY INT,
PLAYROOM_01_CAPACITY INT,
PLAYROOM_02_CAPACITY INT,
PLAYROOM_03_CAPACITY INT,
PLAYROOM_04_CAPACITY INT,
PLAYROOM_05_CAPACITY INT,
PLAYROOM_06_CAPACITY INT,
PLAYROOM_07_CAPACITY INT,
PLAYROOM_08_CAPACITY INT,
PLAYROOM_09_CAPACITY INT,
PLAYROOM_10_CAPACITY INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.UDH_PS2_HTL_VARIABLES(STORE_NBR INT,
DEFAULT_STORE_FLAG STRING,
PS2_HTL_VAR_REC_EFF_DT TIMESTAMP,
PS2_HTL_VAR_REC_END_DT TIMESTAMP,
TY_WEIGHT_PCNT INT,
LY_WEIGHT_PCNT INT,
FRONT_DESK_FIXED_HRS INT,
FRONT_DESK_VAR_HRS INT,
PLAYROOM_VAR_HRS INT,
BACK_OF_HOUSE_FIXED_HRS INT,
BACK_OF_HOUSE_VAR_HRS INT,
OVERNIGHT_TRESHHOLD INT,
OVERNIGHT_UPPER_VALUE INT,
OVERNIGHT_LOWER_VALUE INT,
SUPERVISOR_HRS INT,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_HTL_EARNED(EARN_DAY_DT DATE,
LOCATION_ID INT,
STORE_NBR INT,
WEEK_DT DATE,
FISCAL_WK INT,
FISCAL_MO INT,
FISCAL_YR INT,
OVERNIGHT_KITTY_GUEST_CNT INT,
OVERNIGHT_DOG_GUEST_CNT INT,
OVERNIGHT_TOTAL_GUEST_CNT INT,
DAY_CAMP_PLAYROOM_CNT INT,
DAY_CARE_CNT INT,
OVERNIGHT_WITH_DDC_CNT INT,
TOTAL_DAYCAMP_CNT INT,
TOTAL_GUEST_CNT INT,
NIGHT_PETCARE_SPECIALIST_HRS INT,
FRONT_DESK_HRS INT,
BACK_OF_HOUSE_HRS INT,
SUPERVISOR_HRS INT,
PLAYROOM_HRS INT,
TOTAL_EARNED_HRS INT,
AVG_WAGE_RATE INT,
TOTAL_EARNED_AMT INT,
UPDATE_TSTMP TIMESTAMP,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_HTL_EARN_WAGE_PRE(WEEK_DT TIMESTAMP,
LOCATION_ID INT,
STORE_NBR INT,
BUSINESS_TYPE STRING,
ADJUSTED_AMT INT,
ADJUSTED_HRS INT,
ACTUAL_AMT INT,
ACTUAL_HRS INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_NEW_STORE_PRE(WEEK_DT DATE,
LOCATION_ID INT,
STORE_NBR INT,
SFT_OPEN_DT DATE,
PLAN_SALES_AMT INT,
ACTUAL_SALES_AMT INT,
CUSTOM_AD_HOC_HRS INT,
GRAND_OPENING_HRS INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PLAN_STORE_DAY(DAY_DT DATE,
LOCATION_ID INT,
PLAN_VRSN_NM STRING,
PROFIT_CTR_NM STRING,
PROFIT_CTR_SUB_ID INT,
CURRENCY_TYPE_ID INT,
CURRENCY_TYPE_DESC STRING,
WEEK_DT DATE,
FISCAL_WK INT,
FISCAL_MO INT,
FISCAL_YR INT,
STORE_NBR INT,
COUNTRY_CD STRING,
PROFIT_CTR_SUB_NM STRING,
PLAN_VRSN_DT DATE,
PLAN_SALES_AMT INT,
PLAN_MARGIN_AMT INT,
PLAN_DISCOUNT_AMT INT,
PLAN_ITEM_RMVL_AMT INT,
UPDATE_DT DATE,
LOAD_DT DATE) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.CURRENCY_DAY(DAY_DT TIMESTAMP,
CURRENCY_ID STRING,
DATE_RATE_START TIMESTAMP,
CURRENCY_TYPE STRING,
DATE_RATE_ENDED TIMESTAMP,
EXCHANGE_RATE_PCNT INT,
RATIO_TO INT,
RATIO_FROM INT,
STORE_CTRY_ABBR STRING,
CURRENCY_NBR INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_EARNED_HRS(DAY_DT TIMESTAMP,
LOCATION_ID INT,
WFA_BUSN_AREA_ID INT,
WFA_DEPT_ID INT,
WFA_TASK_ID INT,
STORE_NBR INT,
WFA_BUSN_AREA_DESC STRING,
WFA_DEPT_DESC STRING,
WFA_TASK_DESC STRING,
EARNED_HRS INT,
UPDATE_DT TIMESTAMP,
LOAD_DT TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_C_EARN_PRE(WEEK_DT TIMESTAMP,
LOCATION_ID INT,
WEIGHTED_AVG_WAGE_RATE INT,
ACT_SAL_MGR_AMT INT,
EARNED_OT_HRS INT,
EARNED_OT_AMT INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_NEW_STORE_EARNED(WEEK_DT DATE,
LOCATION_ID INT,
STORE_NBR INT,
SFT_OPEN_DT DATE,
WEEK_STORE_OPENED INT,
PLAN_SALES_AMT INT,
ACTUAL_SALES_AMT INT,
MATRIX_HRS INT,
CUSTOM_AD_HOC_HRS INT,
GRAND_OPENING_HRS INT,
EARNED_HRS INT,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_NEW_STORE_ADHOC_HRS(WEEK_DT DATE,
LOCATION_ID INT,
DEPT_NAME STRING,
DRIVER_NAME STRING,
STORE_NBR INT,
WEEK_DAY1 INT,
WEEK_DAY2 INT,
WEEK_DAY3 INT,
WEEK_DAY4 INT,
WEEK_DAY5 INT,
WEEK_DAY6 INT,
WEEK_DAY7 INT,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_ADJUSTED_LABOR_WK(WEEK_DT TIMESTAMP,
LOCATION_ID INT,
EARN_ID STRING,
STORE_DEPT_NBR STRING,
JOB_CODE INT,
ACT_HOURS_WORKED INT,
ACT_EARNINGS_LOC_AMT INT,
EARNED_HOURS INT,
EARNED_LOC_AMT INT,
FORECAST_HRS INT,
FORECAST_LOC_AMT INT,
EXCHANGE_RATE INT,
UPDATE_DT TIMESTAMP,
LOAD_DT TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_ACCRUED_LABOR_WK(WEEK_DT TIMESTAMP,
LOCATION_ID INT,
STORE_DEPT_NBR STRING,
EARN_ID STRING,
JOB_CODE INT,
FULLPT_FLAG STRING,
PAY_FREQ_CD STRING,
HOURS_WORKED INT,
EARNINGS_AMT INT,
EARNINGS_LOC_AMT INT,
CURRENCY_NBR INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.EMPLOYEE_PROFILE_WK(WEEK_DT TIMESTAMP,
EMPLOYEE_ID INT,
EMPL_FIRST_NAME STRING,
EMPL_MIDDLE_NAME STRING,
EMPL_LAST_NAME STRING,
EMPL_BIRTH_DT TIMESTAMP,
GENDER_CD STRING,
PS_MARITAL_STATUS_CD STRING,
ETHNIC_GROUP_ID STRING,
EMPL_ADDR_1 STRING,
EMPL_ADDR_2 STRING,
EMPL_CITY STRING,
EMPL_STATE STRING,
EMPL_PROVINCE STRING,
EMPL_ZIPCODE STRING,
COUNTRY_CD STRING,
EMPL_HOME_PHONE STRING,
EMPL_EMAIL_ADDR STRING,
EMPL_LOGIN_ID STRING,
BADGE_NBR STRING,
EMPL_STATUS_CD STRING,
STATUS_CHG_DT TIMESTAMP,
FULLPT_FLAG STRING,
FULLPT_CHG_DT TIMESTAMP,
EMPL_TYPE_CD STRING,
PS_REG_TEMP_CD STRING,
EMPL_CATEGORY_CD STRING,
EMPL_GROUP_CD STRING,
EMPL_SUBGROUP_CD STRING,
EMPL_HIRE_DT TIMESTAMP,
EMPL_REHIRE_DT TIMESTAMP,
EMPL_TERM_DT TIMESTAMP,
TERM_REASON_CD STRING,
EMPL_SENORITY_DT TIMESTAMP,
PS_ACTION_DT TIMESTAMP,
PS_ACTION_CD STRING,
PS_ACTION_REASON_CD STRING,
LOCATION_ID INT,
LOCATION_CHG_DT TIMESTAMP,
STORE_NBR INT,
STORE_DEPT_NBR STRING,
COMPANY_ID INT,
PS_PERSONNEL_AREA_ID STRING,
PS_PERSONNEL_SUBAREA_ID STRING,
PS_DEPT_CD STRING,
PS_DEPT_CHG_DT TIMESTAMP,
PS_POSITION_ID INT,
POSITION_CHG_DT TIMESTAMP,
PS_SUPERVISOR_ID INT,
JOB_CODE INT,
JOB_CODE_CHG_DT TIMESTAMP,
EMPL_JOB_ENTRY_DT TIMESTAMP,
PS_GRADE_ID INT,
EMPL_STD_BONUS_PCT INT,
EMPL_OVR_BONUS_PCT INT,
EMPL_RATING INT,
PAY_RATE_CHG_DT TIMESTAMP,
PS_PAYROLL_AREA_CD STRING,
PS_TAX_COMPANY_CD STRING,
PS_COMP_FREQ_CD STRING,
COMP_RATE_AMT INT,
ANNUAL_RATE_LOC_AMT INT,
HOURLY_RATE_LOC_AMT INT,
CURRENCY_ID STRING,
EXCH_RATE_PCT INT,
LOAD_TSTMP TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS_PAYROLL_CALENDAR(CHECK_DT TIMESTAMP,
PS_TAX_COMPANY_CD STRING,
PAY_PERIOD_PARAMETER STRING,
PERIOD_START_DT TIMESTAMP,
PERIOD_END_DT TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.UDH_PS2_CORE_HOLIDAY_LKUP(DAY_DT TIMESTAMP,
DEFAULT_STORE_FLAG STRING,
STORE_NBR INT,
OT_TYPE STRING,
COUNTRY_CD STRING) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_CA_C_EARN_WAGE_PRE(WEEK_DT TIMESTAMP,
LOCATION_ID INT,
TTL_EARNED_HRS INT,
WFA_SAL_MGR_HRS INT,
ACT_SAL_MGR_HRS INT,
ACT_SAL_MGR_AMT INT,
CNT_OF_HRLY_MGRS INT,
AVG_ACT_WAGE_RATE INT,
STR_HRLY_MGR_AVG_WG_RT INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_FACTORS(ROW_NO BIGINT,
FACTOR_TYPE STRING,
LOCATION_ID INT,
STORE_NBR INT,
START_DT TIMESTAMP,
END_DT TIMESTAMP,
FACTOR_DESC STRING,
OTHER STRING,
FACTOR_VALUE INT,
UPDATE_DT TIMESTAMP,
LOAD_DT TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.vw_PetsMartFacility(FacilityGid INT,
FacilityNbr INT,
EDWLocationId INT,
LocationNbr INT,
FacilityName STRING,
FacilityDesc STRING,
FacilityTypeId INT,
FacilityTypeDesc STRING,
CompanyCode STRING,
PhoneNbr STRING,
FaxNbr STRING,
EmailAddress STRING,
StatusFlag STRING,
TimeZoneId INT,
TimeZoneDesc STRING,
AddrLine1 STRING,
AddrLine2 STRING,
City STRING,
StateProvCd STRING,
CountryCd STRING,
PostalCd STRING,
Zip5 STRING,
Zip4 STRING,
County STRING,
Latitude INT,
Longitude INT,
RegionId INT,
DistrictId INT,
HotelFlag INT,
GroomFlag INT,
DaycampFlag INT,
TrainingFlag INT,
AdoptionFlag INT,
VetFlag INT,
OpenDate TIMESTAMP,
CloseDate TIMESTAMP,
SoftOpenDate TIMESTAMP,
GrandOpenDate TIMESTAMP,
JurisdictionTax INT,
CityTaxRate INT,
CountyTaxRate INT,
StateTaxRate INT,
PSTRate INT,
GSTRate INT,
PrimaryDCNbr INT,
ForwardDCNbr INT,
FishDCNbr INT,
DeliverySvcClassId STRING,
PickSvcClassId STRING,
TradeArea STRING,
UpdateTstmp TIMESTAMP,
LoadTstmp TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.UDH_PS2_BLUE_LAW_STORE_LKUP(STORE_NBR INT,
EFF_DT TIMESTAMP,
END_DT TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_CORE_OT_PRE(WEEK_DT DATE,
LOCATION_ID INT,
OVER_TIME_HRS INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_C_EARN_WAGE_PRE(WEEK_DT TIMESTAMP,
LOCATION_ID INT,
TTL_EARNED_HRS INT,
WFA_SAL_MGR_HRS INT,
ACT_SAL_MGR_HRS INT,
ACT_SAL_MGR_AMT INT,
CNT_OF_HRLY_MGRS INT,
AVG_ACT_WAGE_RATE INT,
HOLIDAY_OT_HRS INT,
STR_HRLY_MGR_AVG_WG_RT INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_CORE_HOLIDAY_LKUP(DAY_DT DATE,
DEFAULT_STORE_FLAG STRING,
LOCATION_ID INT,
OT_TYPE STRING,
COUNTRY_CD STRING,
STORE_NBR STRING) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_BLUE_LAW_STORE_LKUP(LOCATION_ID INT,
EFF_DT DATE,
END_DT DATE,
STORE_NBR INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_LABOR_MATRIX(ROW_NO BIGINT,
START_DT TIMESTAMP,
END_DT TIMESTAMP,
STORE_NBR STRING,
BUSINESS_AREA STRING,
DESCRIPTION STRING,
L_RANGE INT,
H_RANGE INT,
VARIABLE_FACTOR INT,
FIXED_HOURS INT,
UPDATE_DT TIMESTAMP,
LOAD_DT TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PETSHOTEL_ACCRUAL(DAY_DT TIMESTAMP,
ACCRUAL_DT TIMESTAMP,
LOCATION_ID INT,
STORE_NBR INT,
TP_INVOICE_NBR BIGINT,
SERVICE_START_DT TIMESTAMP,
SERVICE_END_DT TIMESTAMP,
LENGTH_OF_STAY INT,
TP_EXTENDED_PRICE INT,
PETCOUNT BIGINT,
ACCRUAL_AMT INT,
EXCH_RATE_PCNT INT,
WEEK_DT TIMESTAMP,
FISCAL_YR INT,
FISCAL_MO INT,
FISCAL_WK INT,
LOAD_DT TIMESTAMP) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_HTL_EARN_HRS_PRE(WEEK_DT TIMESTAMP,
LOCATION_ID INT,
STATE_CD STRING,
BUSINESS_TYPE STRING,
TTL_HOTEL_SALES_AMT INT,
EARNED_HRS INT,
EXCH_RATE INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_CA_HTL_EARN_WAGE_PRE(PAY_WEEK_DT TIMESTAMP,
LOCATION_ID INT,
STORE_NBR INT,
BUSINESS_TYPE STRING,
TTL_HRS INT,
TTL_AMT INT) USING DELTA;

CREATE TABLE IF NOT EXISTS DELTA_TRAINING.PS2_CA_HTL_EARN_HRS_PRE(WEEK_DT TIMESTAMP,
PAY_WEEK_DT TIMESTAMP,
LOCATION_ID INT,
STATE_CD STRING,
BUSINESS_TYPE STRING,
TTL_HOTEL_SALES_AMT INT,
EARNED_HRS INT) USING DELTA;